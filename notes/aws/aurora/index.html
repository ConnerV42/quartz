<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Related Notes   AWS Wiki  Relational Database Service  Aurora Key Differences Compared to RDS  Aurora is hosted within RDS, but it has a different enough architecture that it deserves a dedicated page."><title>Aurora</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://wiki.connerv.com//icon.png><link href=https://wiki.connerv.com/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://wiki.connerv.com/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://wiki.connerv.com/js/darkmode.1fd38f434cae056438590d84cdc2b105.min.js></script>
<script src=https://wiki.connerv.com/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://wiki.connerv.com/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://wiki.connerv.com/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://wiki.connerv.com/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://wiki.connerv.com/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://wiki.connerv.com/",fetchData=Promise.all([fetch("https://wiki.connerv.com/indices/linkIndex.9cb4fbbe8787f936346ca7dad0af0b9a.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://wiki.connerv.com/indices/contentIndex.bc539ec1c09854d169a03164790857f6.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://wiki.connerv.com",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://wiki.connerv.com",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1.2,opacityScale:1,repelForce:1.2,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/wiki.connerv.com\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label placeholder><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://wiki.connerv.com/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://wiki.connerv.com/>cvwiki</a></h1><div class=spacer></div><div id=search-icon><p></p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title"/><desc id="desc"/><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title/><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title/><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Aurora</h1><p class=meta>Nov 5, 2022
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/notes/aws/aurora.md rel=noopener></a></p><ul class=tags><li><a href=https://wiki.connerv.com/tags/aws/>Aws</a></li><li><a href=https://wiki.connerv.com/tags/database/>Database</a></li><li><a href=https://wiki.connerv.com/tags/relational-databases/>Relational databases</a></li></ul><aside class=mainTOC><details open><summary></summary><nav id=TableOfContents><ol><li><ol><li><a href=#related-notes>Related Notes</a></li></ol></li><li><a href=#aurora><strong>Aurora</strong></a><ol><li><a href=#key-differences-compared-to-rds>Key Differences Compared to RDS</a></li><li><a href=#general-notes>General Notes</a></li><li><a href=#cost-considerations>Cost Considerations</a></li><li><a href=#aurora-restore-clone--backtrack>Aurora Restore, Clone & Backtrack</a></li></ol></li></ol></nav></details></aside><a href=#related-notes><h3 id=related-notes><span class=hanchor arialabel=Anchor># </span>Related Notes</h3></a><ul><li><a href=/notes/aws/aws-wiki/ rel=noopener class=internal-link data-src=/notes/aws/aws-wiki/>AWS Wiki</a></li><li><a href=/notes/aws/rds/ rel=noopener class=internal-link data-src=/notes/aws/rds/>Relational Database Service</a></li></ul><a href=#aurora><h2 id=aurora><span class=hanchor arialabel=Anchor># </span><strong>Aurora</strong></h2></a><a href=#key-differences-compared-to-rds><h3 id=key-differences-compared-to-rds><span class=hanchor arialabel=Anchor># </span>Key Differences Compared to RDS</h3></a><ul><li>Aurora is hosted within RDS, but it has a different enough architecture that it deserves a dedicated page.</li><li>Uses a cluster, made up of a single primary instances, that has 0 or more replicas.<ul><li>At first, this appears similar to normal RDS, however, the replicas within Aurora can be used for reads during normal operation.</li><li>In this way, it is <em>better</em> than the standby replica inside RDS. The replicas inside of Aurora can actually provide the benefits of both RDS Multi-AZ and RDS Read Replicas.<ul><li>They can be used to improve availability, but they can also be used for read operations during normal operation of a cluster.</li></ul></li><li>Replicas are deployed across multiple AZs.</li></ul></li><li>Aurora doesn&rsquo;t use local storage for the compute instances. It uses a shared cluster storage volumes, which are SSD based, and available to all compute instance within a cluster.<ul><li>This provides faster provisioning, improved availability and improved performance.</li><li>In a 3 AZ setup, the cluster volume has 6 replicas in total across multiple AZs<ul><li>When data is written to the primary DB instance, aurora synchronously replicates that data across all of these 6 storage nodes spread across the AZs associated with your cluster.</li><li>This replication happens at the storage level, so no extra resources are consumed on the primary instance or the replicas instances.</li><li>The chances of disk related failure is greatly minimized with this architecture, and Aurora automatically detects failures in the disk volumes that make up the cluster shared storage, so that when a segments or part of a disk volume fails, Aurora immediately repairs that area of the disk, using the data inside the other storage nodes to bring it back into an operational state with no corruption.</li><li>The need to perform point-in-time restores or snapshot restores to recover from disk failure is greatly reduced.</li></ul></li></ul></li><li>Aurora allows up to 15 replicas, and any of them can be the fail over target for a fail over operation. This is much more than the single standby instance normal RDS allows. The failover operation will also be much faster, because it doesn&rsquo;t have to make any storage modifications.</li><li>Cluster volume storage is all SSD based, which provides high IOPS and low latency. No magnetic storage option</li><li>Storage is billed based on what is consumed, based on a high water mark</li><li>To reduce the high water mark, you have to migrate to a new cluster to lose that high water mark.<ul><li>NOTE: This is no longer part of Aurora in newer versions</li></ul></li><li>Aurora clusters, like RDS, use reader endpoints<ul><li>The reader endpoints automatically load balance across read replicas<ul><li>In addition, each read replica has a dedicated endpoint if needed</li></ul></li></ul></li></ul><a href=#general-notes><h3 id=general-notes><span class=hanchor arialabel=Anchor># </span>General Notes</h3></a><ul><li><strong>Amazon Aurora Global Database</strong> is specifically designed for globally distributed applications, allowing a single Amazon Aurora database to span multiple AWS regions. It replicates your data with no impact on database performance, enables fast local reads with low latency in each region, and provides disaster recovery from region-wide outages. Aurora Global Database supports storage-based replication that has a latency of less than 1 second. If there is an unplanned outage, one of the secondary regions you assigned can be promoted to read and write capabilities in less than 1 minute. This feature is called <strong>Cross-Region Disaster Recovery</strong>.</li><li>Aurora typically involves a cluster of DB instances instead of a single instance. Each connection is handled by a specific DB instance. When you connect to an Aurora cluster, the hostname and port that you specify point to an intermediate handler called an endpoint. Aurora uses the endpoint mechanism to abstract these connections. Thus, you don&rsquo;t have to hardcode all the hostnames or write your own logic for load-balancing and rerouting connections when some DB instances aren&rsquo;t available.</li><li><strong>Aurora Serverless</strong> is an on-demand, auto-scaling configuration for Amazon Aurora. An Aurora Serverless DB cluster is a DB cluster that automatically starts up, shuts down, and scales up or down its compute capacity based on your application&rsquo;s needs. Aurora Serverless provides a relatively simple, cost-effective option for infrequent, intermittent, sporadic, or unpredictable workloads. It can provide this because it automatically starts up, scales compute capacity to match your application&rsquo;s usage and shuts down when it&rsquo;s not in use</li><li><strong>Load Balancing Across Aurora DB Instances</strong><ul><li>Amazon Aurora typically involves a cluster of DB instances instead of a single instance. Each connection is handled by a specific DB instance. When you connect to an Aurora cluster, the hostname and port that you specify point to an intermediate handler called an endpoint. Aurora uses the endpoint mechanism to abstract these connections. Thus, you don’t have to hardcode all the hostnames or write your own logic for load-balancing and rerouting connections when some DB instances aren&rsquo;t available.</li><li>For certain Aurora tasks, different instances or groups of instances perform different roles. For example, the primary instance handles all data definition language (DDL) and data manipulation language (DML) statements. Up to 15 Aurora Replicas handle read-only query traffic.</li><li>Using endpoints, you can map each connection to the appropriate instance or group of instances based on your use case. For example, to perform DDL statements you can connect to whichever instance is the primary instance. To perform queries, you can connect to the reader endpoint, with Aurora automatically performing load-balancing among all the Aurora Replicas. For clusters with DB instances of different capacities or configurations, you can connect to custom endpoints associated with different subsets of DB instances. For diagnosis or tuning, you can connect to a specific instance endpoint to examine details about a specific DB instance.</li></ul></li><li><strong>Failover</strong> is automatically handled by Amazon Aurora so that your applications can resume database operations as quickly as possible without manual administrative intervention.<ul><li>If you have an Amazon Aurora Replica in the same or a different Availability Zone, when failing over, Amazon Aurora flips the canonical name record (CNAME) for your DB Instance to point at the healthy replica, which in turn is promoted to become the new primary. Start-to-finish, failover typically completes within 30 seconds.</li><li>If you are running Aurora Serverless and the DB instance or AZ become unavailable, Aurora will automatically recreate the DB instance in a different AZ.</li><li>If you do not have an Amazon Aurora Replica (i.e. single instance) and are not running Aurora Serverless, Aurora will attempt to create a new DB Instance in the same Availability Zone as the original instance. This replacement of the original instance is done on a best-effort basis and may not succeed, for example, if there is an issue that is broadly affecting the Availability Zone.</li></ul></li><li>Handles highly transactional (OLTP) workloads</li></ul><a href=#cost-considerations><h3 id=cost-considerations><span class=hanchor arialabel=Anchor># </span>Cost Considerations</h3></a><ul><li>Aurora has no free-tier option</li><li>Aurora doesn&rsquo;t support micro instances</li><li>Beyond RDS single-AZ (micro) Aurora offers better value</li><li>Compute - hourly charge, billed per second, with a 10 minute minimum</li><li>Storage - GB-Month consumed, IO cost per request</li><li>100% DB size in backups are included</li></ul><a href=#aurora-restore-clone--backtrack><h3 id=aurora-restore-clone--backtrack><span class=hanchor arialabel=Anchor># </span>Aurora Restore, Clone & Backtrack</h3></a><ul><li>Backups in Aurora work in the same way as RDS</li><li>Restores create a new cluster</li><li>Backtrack can be used which allow in-place rewinds to a previous point in time<ul><li>Needs to be enabled on a per-cluster basis</li><li>Exclusive to Aurora at the time that this note was taken</li></ul></li><li>Fast clones make a new database much faster than copying all the data - copy-on-write</li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3></h3><ul class=backlinks><li><a href=/notes/aws/aws-wiki/ data-ctx=Aurora data-src=/notes/aws/aws-wiki class=internal-link>AWS Wiki</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3></h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://wiki.connerv.com/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p></p><ul><li><a href=https://wiki.connerv.com/></a></li></ul></footer></div></div></body></html>